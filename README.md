# Video Anomaly Detection Based on Dual-Path Reconstruction and Multi-Source Pseudo-Anomaly Augmentation

Official PyTorch implementation of the paper "Video Anomaly Detection Based on Dual-Path Reconstruction and Multi-Source Pseudo-Anomaly Augmentation".

## Overview

This paper proposes a video anomaly detection method based on a Multi-Source Pseudo-Anomaly Generator and a Dual-Decoder Framework. We design a unified generator that integrates spatiotemporal perturbations (frame skipping, motion shuffling, Gaussian noise) and introduces an object-level local appearance perturbation strategy based on YOLOv3 and CIFAR-100. Furthermore, the dual-path decoder (equipped with independent dual memory modules $M_n$ and $M_p$) explicitly decouples normal and abnormal features in the latent space, maximizing the reconstruction error of anomalous samples.

## Requirements

- Python >= 3.9
- PyTorch >= 1.12
- CUDA >= 11.7
- Other dependencies:
  - `numpy`
  - `opencv-python`
  - `scikit-learn` (for AUC calculation)

## Training/Inference
Train and evaluate the model in file "main.py".

```bash
python main.py
```
 
## Points
### Datasets
To validate and benchmark our method against the state of the art, we conduct experiments on several diverse datasets: [UCSD Ped2](http://www.svcl.ucsd.edu/projects/anomaly/dataset.htm), [CUHK Avenue](http://www.cse.cuhk.edu.hk/leojia/projects/detectabnormal/dataset.html), [ShanghaiTech](https://svip-lab.github.io/dataset/campus_dataset.html).

### YOLOv3 Weights
*Download the weight into `Yolov3/yolov3/weights` folder like `Yolov3/yolov3/weights/yolov3-spp-ultralytics.pt`ï¼š[YOLOv3 Weights](https://drive.google.com/file/d/1n4Yazein383Q9LXsW1oHXeFib-HlO1w4/view?usp=drive_link)

### Anomalies
We simulate anomalous behavior by constructing a Multi-Source Pseudo-Anomaly Generator that covers both temporal and spatial dimensions.The pseudo-anomalies consist of four distinct types: frame skipping, motion shuffling, Gaussian noise, and object-level local appearance perturbation (utilizing YOLOv3 & CIFAR-100). We limit the pseudo-anomaly data in the model by probability `p`. The temporal perturbations are architected in file `data.py`, Gaussian noise is added in `utils.py`, and object-level masks are generated by `Object_Mask.py`.
